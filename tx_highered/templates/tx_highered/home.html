{% extends "tx_highered/app_base.html" %}
{% load url from future %}
{% load webdesign %}


{% block opengraph_meta %}{{ block.super }}
  <meta property="og:title" content="The Texas Tribune Higher Education Explorer">
  <meta property="og:description" content="">
{% endblock %}


{% block adsense_slots %}{{ block.super }}
  {% include "tx_highered/includes/app_meta.html" %}
{% endblock %}


{% block page_title %}Higher Education Explorer | {{ block.super }}{% endblock %}


{% block breadcrumb_base %}{% endblock %}


{% block main %}
  <div class="row landing">
    <div class="span8">
      <section id="intro">
        <p>
          {% lorem 33 w %}
        </p>
      </section>

      <hr>

      <section class="row-fluid">
        <div class="graphic pull-right">
          <img src="http://s3.amazonaws.com/static.texastribune.org/common/tx_schools/statewide-search-icon.png" />
        </div>

        <div>
          <h2>Search for Institutions</h2>

          <p>
            {% lorem 28 w %}
          </p>


          <form class="form-inline">
            <input type="text" class="q" placeholder="Institution name">
          </form>

        </div>
        <hr>
        {% if short_list %}
          <div class="well well-small sans-serif">
            <h4>Top {{ short_list|length }} Higher Education Institutions by Enrollment:</h4>
            {% for object in short_list %}
              <a href="{{ object.get_absolute_url }}">{{ object.name }}</a>
              {% if not forloop.last %}
                <span class="divider">&bull;</span>
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}
      </section>

      <section id="view-map" class="row-fluid map-container">
        <div>
          <h2>
            View Institutions Statewide
            <small>
              <a href="#" class="btn btn-mini reset active" data-action="reset">All</a>
              <a href="#" class="btn btn-mini public" data-action="public">Public</a>
              <a href="#" class="btn btn-mini private" data-action="private">Private</a>
            </small>
          </h2>

          {# {% lorem 1 p %} #}

          <button id="statewideZoom" class="btn" style="position:absolute; display:block; margin: 0 auto -40px;">
            Return to statewide view
          </button>

          <div id="mapCanvas"></div>
        </div>
      </section>
    </div>

    <div class="span4">
      <div class="well well-small" style="font-size: 85%;">
        The <a href="{% url 'tx_highered:home' %}">Higher Education Explorer</a>
        was created with support from the <em>Greater Texas Foundation</em>
        <div style="border-width: 1px 0px; border-style: solid; padding: 0.5em 0px; border-color: rgb(204, 204, 204); margin: 1em 0px;">
          <img src="//s3.amazonaws.com/static.texastribune.org/apps/highered/greater-texas-foundation-276x168.png" alt="">
        </div>
      </div>

      {% include "tx_highered/includes/home_rail.html" %}
    </div>
  </div>

<div id="mapPopupContainer" class="shadow"><h4>Hover over a campus</h4></div>

{# TODO associate with maps.js #}
<script id="mapPopup" type="text/x-handlebars-template">
  <h2>{% templatetag openvariable %}name{% templatetag closevariable %}</h2>
  <h4>{% templatetag openvariable %}city{% templatetag closevariable %}, TX</h4>
</script>
{% endblock %}


{% block extra_style %}{{ block.super }}
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.4/leaflet.css" />
  <!--[if lte IE 8]><link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.4/leaflet.ie.css" /><![endif]-->
{% endblock %}


{% block extra_script %}{{ block.super }}
  <script src="http://cdn.leafletjs.com/leaflet-0.4.4/leaflet-src.js"></script>
  <script src="http://cloud.github.com/downloads/wycats/handlebars.js/handlebars-1.0.0.beta.6.js"></script>
  <script src="{{ STATIC_URL }}tx_highered/js/maps.js"></script>
  <script>
    $(function() {
      // Go to the server for institution API data
      $.get("{% url 'tx_highered:institution_api' %}?fields=city,geojson,is_private",
        function(data) {
          autocomplete_institutions(data);
          map_institutions(data);
        }
      );
    });
  </script>
{% endblock %}
